---
title: "team"
author: "Colin Willenborg, John King, Allan Juarez"
date: "9/8/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
```

## The Best rated Companies - Colin Willenborg
```{r}
choco <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/data/choco.csv")
# Problem 5 best company over all.
RateCompany <- choco %>%
  group_by(Company) %>%
  summarise_at(vars(Rating), funs(mean(., na.rm=TRUE))) %>%
  arrange(-Rating)
plot(factor(RateCompany$Company), RateCompany$Rating, main="Ratings vs Companies", las=3)
```

```{r}
RateCompany
```

```{r}
tail(RateCompany,10)
```

## Change in scoring over the years - John King

First, to see if evaluating how scores have changed over the years makes a valid comparison, we need to check if there is plenty of data to use each year.

```{r}
chocoYR <- choco[, c("Date", "Rating")]
chocoTable <- addmargins(table(chocoYR), 2)
chocos <- as.data.frame(chocoTable)
chocos[chocos$Rating == "Sum", c("Date", "Freq")]
```

As can be seen by the table above, nearly every year has a plenitude of data. The first point of investigation is whether scoring tendencies have changed over time. We can check this by finding the average score in a year and plotting each average score in a scatterplot. The upcoming chart does this.

```{r}
chocoAgg <- aggregate(choco[, "Rating"], FUN = mean, list(choco$Date))
plot(chocoAgg, main="Average rating per year", xlab = "Year", ylab = "Rating")

```

Before the analysis, note that the y-axis labels are from 3.0 to 3.4. For visibility's sake, the change in average rating between years has been exaggerated.
The chart shows a slight positive correlation between year and rating. However, we have no knowledge of why this may be the case. Perhaps companies have been improving in making chocolate or perhaps the correlation might be due a shift in how database raters perceive the chocolate.

## Allan's Answer

```{r}

twoIngredients <- choco$Ingredients == '2- B,S'
two <- choco[twoIngredients,]
threeIngredient <- choco$Ingredients == '3- B,S,C'
three <- choco[threeIngredient,]
fourIngredients <- choco$Ingredients == '4- B,S,C,V'
four <- choco[fourIngredients,]
fiveIngedient <- choco$Ingredients == '5-B,S,C,V,Sa'
five <- choco[fiveIngedient,]
sixIngredients <- choco$Ingredients == '6-B,S,C,V,L,Sa'
six <- choco[sixIngredients,]
specialFour <- choco$Ingredients == '4- B,S*,C,Sa'
specFour <- choco[specialFour,]
specialThree <- choco$Ingredients == '3- B,S*,C'
specThree <- choco[specialThree,]

data <- c(0,mean(two$Rating, na.rm = TRUE),
mean(three$Rating, na.rm = TRUE),
mean(four$Rating, na.rm = TRUE),
mean(five$Rating, na.rm = TRUE),
mean(six$Rating, na.rm = TRUE),
mean(specThree$Rating, na.rm = TRUE),
mean(specFour$Rating, na.rm = TRUE))

name <- c("two", "three", "four", "five", "six", "three*", "four*")


plot(data, main =" average ratings per number of ingredients" ,xlab= "number of ingredients",xlim = c(2, 8) , ylab = "rating", ylim =c(2.5,3.5))

```
(7 is two special ingredients and 8 is three  special ingredients)

The best rating only had three ingredients. After three the ratings drop significantly and never really rose until 8 which is also three ingredients but they had some sort of special ingredients. Three ingredients had a high of 3.27 rating and the lowest rating was six ingredients of 2.79. It seems optimal to only use three or two ingredients to get a higher rating.
